<!DOCTYPE html>

<html lang="zh-TW">
<head>
<meta charset="utf-8"/>
<title>Á©∫Ê±°Èò≤Âà∂Ë©¶ÁÆó - ÂÆåÊï¥Á≥ªÁµ±</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    body { font-family: sans-serif; background: #f3f6fa; padding: 2em; }
    .container { max-width: 1200px; background: white; margin: auto; padding: 2em; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.05); }
    h2 { color: #0056b3; }
    label { font-weight: bold; display: block; margin-top: 1em; }
    input, select { width: 100%; padding: 0.5em; margin-top: 0.3em; font-size: 1em; }
    table { width: 100%; border-collapse: collapse; margin-top: 1em; }
    th, td { border: 1px solid #ccc; padding: 0.5em; text-align: center; }
    button { padding: 1em; font-size: 1em; margin-top: 1em; background: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; }
    .warning { color: red; margin-top: 1em; }
    .export-group button { width: 48%; margin: 1% 1% 0 0; }
    canvas { margin-top: 2em; max-width: 600px; }
  
<style>
  body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #eef3f9; padding: 2em; }
  .container {
    background: #ffffff;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 0 20px rgba(0,0,0,0.05);
    border: 1px solid #d4dbe5;
  }
  h1, h2 {
    margin: 0.2em 0;
  }
  label {
    font-weight: bold;
    margin-top: 1em;
    display: block;
  }
  input, select {
    border: 1px solid #ccc;
    border-radius: 6px;
    padding: 0.5em;
    font-size: 1em;
    width: 100%;
    margin-top: 0.3em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
    background: #fefefe;
  }
  th {
    background: #007bff;
    color: white;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #ccc;
  }
  button {
    background: #28a745;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 1em;
    font-size: 1.1em;
    cursor: pointer;
    margin-top: 1em;
    width: 100%;
  }
  button:hover {
    background: #218838;
  }
  .warning {
    color: #d9534f;
    background: #fbeaea;
    border-left: 5px solid #d43f3a;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  canvas {
    margin-top: 2em;
    background: #fff;
    border-radius: 10px;
    padding: 1em;
    box-shadow: 0 0 10px rgba(0,0,0,0.05);
  }

<style>
  .header-bar {
    background: linear-gradient(to right, #0a5d5d, #007bff);
    padding: 1em;
    border-radius: 10px;
    color: white;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 48px;
    margin-right: 1em;
  }
  .section {
    background: #f9fcff;
    padding: 1em 1.5em;
    border: 1px solid #dde6f0;
    border-radius: 10px;
    margin-top: 2em;
  }
  .section h3 {
    color: #007bff;
    margin-top: 0;
    border-bottom: 1px solid #cde;
    padding-bottom: 0.3em;
  }
  .button-row {
    display: flex;
    justify-content: space-between;
    gap: 1em;
  }

<style>
  .container {
    background: linear-gradient(to bottom right, #ffffff, #f0f4fa);
    padding: 2em;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
  }
  .header-bar {
    background: linear-gradient(to right, #0a5d5d, #0099cc);
    color: white;
    padding: 1em 1.5em;
    border-radius: 12px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }
  .header-bar img { height: 50px; margin-right: 1em; }
  h1 { font-size: 1.7em; margin: 0; }
  h2 { font-size: 1.2em; margin: 0; font-weight: 400; }
  .section {
    background: white;
    padding: 1.2em 1.5em;
    border: 1px solid #dde6f0;
    border-radius: 14px;
    margin-top: 2em;
    box-shadow: 0 3px 10px rgba(0,0,0,0.03);
    transition: box-shadow 0.3s ease;
  }
  .section:hover {
    box-shadow: 0 6px 16px rgba(0,0,0,0.06);
  }
  .section h3::before {
    content: 'üõ†Ô∏è ';
    font-weight: normal;
  }
  .section h3 {
    color: #0077cc;
    border-bottom: 1px solid #cde;
    padding-bottom: 0.3em;
    margin-top: 0;
  }
  button {
    background: linear-gradient(to right, #28a745, #218838);
    color: white;
    border: none;
    border-radius: 10px;
    padding: 1em;
    font-size: 1.1em;
    cursor: pointer;
    width: 100%;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
  }
  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 18px rgba(0,0,0,0.15);
  }
  canvas {
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.04);
    padding: 1em;
  }

<style>
  .section {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
  .section.visible {
    opacity: 1;
    transform: translateY(0);
  }
  .card-hover:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  }
  .total-animated {
    font-size: 1.3em;
    color: #28a745;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }

table td, table th {
  vertical-align: middle;
}

table td input[type="number"],
table td input[type="text"],
table td select {
  text-align: center;
}
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  .section {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
  .section.visible {
    opacity: 1;
    transform: translateY(0);
  }
  .card-hover:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  }
  .total-animated {
    font-size: 1.3em;
    color: #28a745;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  .container {
    background: linear-gradient(to bottom right, #ffffff, #f0f4fa);
    padding: 2em;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
  }
  .header-bar {
    background: linear-gradient(to right, #0a5d5d, #0099cc);
    color: white;
    padding: 1em 1.5em;
    border-radius: 12px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }
  .header-bar img { height: 50px; margin-right: 1em; }
  h1 { font-size: 1.7em; margin: 0; }
  h2 { font-size: 1.2em; margin: 0; font-weight: 400; }
  .section {
    background: white;
    padding: 1.2em 1.5em;
    border: 1px solid #dde6f0;
    border-radius: 14px;
    margin-top: 2em;
    box-shadow: 0 3px 10px rgba(0,0,0,0.03);
    transition: box-shadow 0.3s ease;
  }
  .section:hover {
    box-shadow: 0 6px 16px rgba(0,0,0,0.06);
  }
  .section h3::before {
    content: 'üõ†Ô∏è ';
    font-weight: normal;
  }
  .section h3 {
    color: #0077cc;
    border-bottom: 1px solid #cde;
    padding-bottom: 0.3em;
    margin-top: 0;
  }
  button {
    background: linear-gradient(to right, #28a745, #218838);
    color: white;
    border: none;
    border-radius: 10px;
    padding: 1em;
    font-size: 1.1em;
    cursor: pointer;
    width: 100%;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
  }
  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 18px rgba(0,0,0,0.15);
  }
  canvas {
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.04);
    padding: 1em;
  }

<style>
  .section {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
  .section.visible {
    opacity: 1;
    transform: translateY(0);
  }
  .card-hover:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  }
  .total-animated {
    font-size: 1.3em;
    color: #28a745;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  .section {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
  .section.visible {
    opacity: 1;
    transform: translateY(0);
  }
  .card-hover:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  }
  .total-animated {
    font-size: 1.3em;
    color: #28a745;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  .header-bar {
    background: linear-gradient(to right, #0a5d5d, #007bff);
    padding: 1em;
    border-radius: 10px;
    color: white;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 48px;
    margin-right: 1em;
  }
  .section {
    background: #f9fcff;
    padding: 1em 1.5em;
    border: 1px solid #dde6f0;
    border-radius: 10px;
    margin-top: 2em;
  }
  .section h3 {
    color: #007bff;
    margin-top: 0;
    border-bottom: 1px solid #cde;
    padding-bottom: 0.3em;
  }
  .button-row {
    display: flex;
    justify-content: space-between;
    gap: 1em;
  }

<style>
  .container {
    background: linear-gradient(to bottom right, #ffffff, #f0f4fa);
    padding: 2em;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
  }
  .header-bar {
    background: linear-gradient(to right, #0a5d5d, #0099cc);
    color: white;
    padding: 1em 1.5em;
    border-radius: 12px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }
  .header-bar img { height: 50px; margin-right: 1em; }
  h1 { font-size: 1.7em; margin: 0; }
  h2 { font-size: 1.2em; margin: 0; font-weight: 400; }
  .section {
    background: white;
    padding: 1.2em 1.5em;
    border: 1px solid #dde6f0;
    border-radius: 14px;
    margin-top: 2em;
    box-shadow: 0 3px 10px rgba(0,0,0,0.03);
    transition: box-shadow 0.3s ease;
  }
  .section:hover {
    box-shadow: 0 6px 16px rgba(0,0,0,0.06);
  }
  .section h3::before {
    content: 'üõ†Ô∏è ';
    font-weight: normal;
  }
  .section h3 {
    color: #0077cc;
    border-bottom: 1px solid #cde;
    padding-bottom: 0.3em;
    margin-top: 0;
  }
  button {
    background: linear-gradient(to right, #28a745, #218838);
    color: white;
    border: none;
    border-radius: 10px;
    padding: 1em;
    font-size: 1.1em;
    cursor: pointer;
    width: 100%;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
  }
  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 18px rgba(0,0,0,0.15);
  }
  canvas {
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.04);
    padding: 1em;
  }

<style>
  .section {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
  .section.visible {
    opacity: 1;
    transform: translateY(0);
  }
  .card-hover:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  }
  .total-animated {
    font-size: 1.3em;
    color: #28a745;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  .section {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
  .section.visible {
    opacity: 1;
    transform: translateY(0);
  }
  .card-hover:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  }
  .total-animated {
    font-size: 1.3em;
    color: #28a745;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  .container {
    background: linear-gradient(to bottom right, #ffffff, #f0f4fa);
    padding: 2em;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
  }
  .header-bar {
    background: linear-gradient(to right, #0a5d5d, #0099cc);
    color: white;
    padding: 1em 1.5em;
    border-radius: 12px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }
  .header-bar img { height: 50px; margin-right: 1em; }
  h1 { font-size: 1.7em; margin: 0; }
  h2 { font-size: 1.2em; margin: 0; font-weight: 400; }
  .section {
    background: white;
    padding: 1.2em 1.5em;
    border: 1px solid #dde6f0;
    border-radius: 14px;
    margin-top: 2em;
    box-shadow: 0 3px 10px rgba(0,0,0,0.03);
    transition: box-shadow 0.3s ease;
  }
  .section:hover {
    box-shadow: 0 6px 16px rgba(0,0,0,0.06);
  }
  .section h3::before {
    content: 'üõ†Ô∏è ';
    font-weight: normal;
  }
  .section h3 {
    color: #0077cc;
    border-bottom: 1px solid #cde;
    padding-bottom: 0.3em;
    margin-top: 0;
  }
  button {
    background: linear-gradient(to right, #28a745, #218838);
    color: white;
    border: none;
    border-radius: 10px;
    padding: 1em;
    font-size: 1.1em;
    cursor: pointer;
    width: 100%;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
  }
  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 18px rgba(0,0,0,0.15);
  }
  canvas {
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.04);
    padding: 1em;
  }

<style>
  .section {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
  .section.visible {
    opacity: 1;
    transform: translateY(0);
  }
  .card-hover:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  }
  .total-animated {
    font-size: 1.3em;
    color: #28a745;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  .section {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
  .section.visible {
    opacity: 1;
    transform: translateY(0);
  }
  .card-hover:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  }
  .total-animated {
    font-size: 1.3em;
    color: #28a745;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  body {
    background: #fdfdfc;
    color: #333;
    font-family: 'Noto Serif TC', 'Times New Roman', serif;
  }
  .container {
    background: white;
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    padding: 2em;
    max-width: 1200px;
    margin: auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .header-bar {
    background: #2d4739;
    color: #fff8e1;
    padding: 1em 1.5em;
    border-radius: 10px;
    margin-bottom: 2em;
    display: flex;
    align-items: center;
  }
  .header-bar img {
    height: 50px;
    margin-right: 1em;
  }
  h1 { font-size: 1.6em; color: #fffad1; }
  h2 { font-size: 1.1em; font-weight: 400; color: #f1f1f1; }
  h3 {
    color: #2d4739;
    border-bottom: 1px solid #a39866;
    padding-bottom: 0.3em;
    margin-top: 1em;
  }
  .section {
    background: #fefefe;
    padding: 1.2em 1.5em;
    border: 1px solid #c7c7a6;
    border-radius: 12px;
    margin-top: 2em;
  }
  input, select {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: 0.5em;
    background: #fefefe;
    font-size: 1em;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1em;
  }
  th {
    background: #2d4739;
    color: #fff8e1;
    padding: 0.5em;
  }
  td {
    padding: 0.5em;
    border: 1px solid #aaa;
  }
  button {
    background: #b38d00;
    color: white;
    border: none;
    padding: 1em;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #9f7a00;
  }
  canvas {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    padding: 1em;
    margin-top: 2em;
  }
  .warning {
    background: #fff4e5;
    color: #9c4d00;
    border-left: 6px solid #e6a100;
    padding: 0.8em;
    margin-top: 1em;
    border-radius: 6px;
  }
  .total-animated {
    font-size: 1.3em;
    color: #b38d00;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
  }

<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  #typewriter {
    display: inline-block;
    font-size: 1.2em;
    font-weight: 500;
    color: #b38d00;
    border-right: 2px solid #b38d00;
    white-space: nowrap;
    overflow: hidden;
    animation: blink 0.7s infinite;
  }
  @keyframes blink {
    0%, 100% { border-color: transparent; }
    50% { border-color: #b38d00; }
  }

<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
  thead th {
    position: sticky;
    top: 0;
    background: #2d4739;
    z-index: 1;
  }
  .accordion-section {
    display: none;
  }
  .chart-summary {
    text-align: center;
    font-size: 0.9em;
    color: #444;
    margin-top: 1em;
  }
  @media (max-width: 768px) {
    .accordion-section {
      display: block;
    }
    .section {
      display: none;
    }
    .section.accordion-visible {
      display: block;
    }
    .accordion-toggle {
      width: 100%;
      text-align: left;
      font-size: 1em;
      font-weight: bold;
      padding: 0.8em;
      margin-top: 1em;
      background: #eee;
      border: none;
      border-left: 6px solid #b38d00;
      border-radius: 6px;
    }
  }
</style>
<style>
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1em;
  font-size: 14px;
}

table th, table td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}

table th {
  background-color: #2c3e50;
  color: white;
  font-weight: bold;
}

table tr:nth-child(even):not(#auto-wash-row) {
  background-color: #f9f9f9;
}

input[type="text"], input[type="number"], select {
  width: 90%;
  padding: 4px;
  font-size: 13px;
  box-sizing: border-box;
}
</style><style>
/* Âç°ÁâáÂÆπÂô® */
.card {
  background: #ffffff;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  border-radius: 10px;
  padding: 20px;
  margin: 20px auto;
  overflow-x: auto;
  max-width: 95%;
}

/* Ë°®Ê†ºÊ®£Âºè‰øùÁïô */
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
  min-width: 800px;
}

table th, table td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}

table th {
  background-color: #2c3e50;
  color: white;
  font-weight: bold;
}

table tr:nth-child(even):not(#auto-wash-row) {
  background-color: #f9f9f9;
}

/* Ë°®ÂñÆÊ¨Ñ‰Ωç */
input[type="text"], input[type="number"], select {
  width: 90%;
  padding: 4px;
  font-size: 13px;
  box-sizing: border-box;
}

/* Ë°®ÂñÆÈ©óË≠âÈåØË™§ */
input:invalid {
  border: 2px solid red;
}
</style><style>
.card {
  background: #ffffff;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  border-radius: 10px;
  padding: 20px;
  margin: 20px auto;
  overflow-x: auto;
  max-width: 95%;
}

table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
  min-width: 800px;
}

table th, table td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}

table th {
  background-color: #2c3e50;
  color: white;
  font-weight: bold;
}

table tr:nth-child(even):not(#auto-wash-row) {
  background-color: #f9f9f9;
}

input[type="text"], input[type="number"], select {
  width: 90%;
  padding: 4px;
  font-size: 13px;
  box-sizing: border-box;
}

input:invalid {
  border: 2px solid red;
}

/* Á∏ΩÈáëÈ°çÂçÄ */
.total-footer {
  position: sticky;
  bottom: 0;
  background-color: #ecf0f1;
  padding: 10px;
  font-weight: bold;
  border-top: 2px solid #aaa;
  text-align: right;
}

/* Êñ∞Â¢ûÊåâÈàï */
button.add-row {
  margin: 10px 0;
  padding: 6px 14px;
  background-color: #3498db;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

/* È°ûÂûãÊ®ôÁ±§ */
.label {
  display: inline-block;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 12px;
  color: white;
}

.label-Âª∫ÁØâ { background-color: #2ecc71; }
.label-ÈÅìË∑Ø { background-color: #f39c12; }
.label-Ê©ãÊ¢Å { background-color: #8e44ad; }
.label-ÁÆ°Á∑ö { background-color: #d35400; }
.label-ÁñèÊø¨ { background-color: #2980b9; }
.label-ÂçÄÂüüÈñãÁôº { background-color: #c0392b; }
</style><style>
body {
  font-family: "Segoe UI", sans-serif;
  background-color: #f8f9f9;
  margin: 0;
  padding: 0;
}

h1, h2, h3 {
  color: #1c4c2f;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin: 16px auto;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  border-radius: 8px;
  overflow: hidden;
}

table th, table td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}

table th {
  background-color: #2e7d32;
  color: #fff;
  font-weight: bold;
  position: sticky;
  top: 0;
  z-index: 1;
}

table tr:hover {
  background-color: #f1f8e9;
}

input[type="text"],
input[type="number"],
select {
  padding: 4px 8px;
  border-radius: 4px;
  border: 1px solid #ccc;
  width: 90%;
}

input[type="text"]:focus,
input[type="number"]:focus {
  border-color: #43a047;
  outline: none;
  box-shadow: 0 0 0 2px rgba(67, 160, 71, 0.2);
}

button {
  background-color: #388e3c;
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 14px;
}

button:hover {
  background-color: #2e7d32;
}
</style><style>
@media (max-width: 768px) {
  .table-wrapper {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  table {
    width: 900px;
  }
  input, select, button {
    width: 100%;
    box-sizing: border-box;
  }
}
</style></head>
<body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<div class="container">
<div class="header-bar">
<div>
<h1 style="margin: 0;">Ëá∫Êù±Á∏£Áí∞‰øùÂ±Ä</h1>
<h2 style="margin: 0; font-size: 1.1em;"><span id="typewriter"></span></h2>
</div></div>
<div style="display:flex; align-items: center; margin-bottom: 1em;">
<div>
<h1 style="margin: 0; font-size: 1.5em; color: #0a5d5d;">Ëá∫Êù±Á∏£Áí∞‰øùÂ±Ä</h1>
<h2 style="margin: 0; font-size: 1.2em; color: #0056b3;"><span id="typewriter"></span></h2>
</div>
</div>
<label>Â∑•Á®ãÈ°ûÂûã</label>
<select id="type"><option value="Âª∫ÁØâ">Âª∫ÁØâ</option><option value="ÈÅìË∑Ø">ÈÅìË∑Ø</option><option value="Ê©ãÊ¢Å">Ê©ãÊ¢Å</option><option value="ÁÆ°Á∑ö">ÁÆ°Á∑ö</option><option value="ÁñèÊø¨">ÁñèÊø¨</option><option value="ÂçÄÂüüÈñãÁôº">ÂçÄÂüüÈñãÁôº</option></select><div id="stockpile-area" style="display:none; margin-top:10px;"><label for="stockpile">ÊòØÂê¶Ë®≠ÁΩÆÂ±ØÂúüÂçÄÔºö<select id="stockpile"><option value="ÊòØ">ÊòØ</option><option value="Âê¶">Âê¶</option></select></label></div><div id="type-label" style="margin-top:5px;"></div>
<label>ÊñΩÂ∑•ÈöéÊÆµ</label>
<select id="stage"><option>ÂúüÊñπÈñãÊåñ</option><option>ÁµêÊßãÈ´îÊñΩÂ∑•</option><option>ÊãÜÈô§Â∑•Á®ã</option></select>
<label>Â∑•ÊúüÔºàÊúàÔºâ</label><input id="duration" type="number"/>
<label>Â∑•ÂçÄÈù¢Á©çÔºàm¬≤Ôºâ</label><input id="area" type="number"/>
<label>ÊòØÂê¶ÊúâËªäËºõÈÄ≤Âá∫</label><select id="hasVehicleAccess"><option value="ÊòØ">ÊòØ</option><option value="Âê¶">Âê¶</option></select>
<div class="section"><h3>üìã Èò≤Âà∂Ë®≠ÊñΩÊï∏ÈáèËàáÂñÆÂÉπ</h3><div class="card"><table><thead><tr><th>È†ÖÁõÆ</th><th>Êï∏Èáè</th><th>ÂñÆ‰Ωç</th><th>ÂñÆÂÉπ</th></tr></thead><tbody id="facilityTable"></tbody></table></div><button class="add-row" id="add-row">‚ûï Êñ∞Â¢ûÈ†ÖÁõÆ</button><div class="total-footer"><span id="total-value">Á∏ΩÈáëÈ°çÂêàË®àÔºö0 ÂÖÉ</span></div>
<button onclick="calculate()">Âü∑Ë°åË©¶ÁÆóËàáÂúñË°®ËàáÊ≥ïË¶èÊ™¢Êü•</button>
</div><div class="section"><h3>üßÆ Ë©¶ÁÆóÁµêÊûúËàáÊ≥ïË¶èÊèêÈÜí</h3><div id="result" style="margin-top: 2em;"></div>
</div><div class="section"><h3>üìä Á∂ìË≤ªÂç†ÊØîÂúñ</h3><canvas id="chart"></canvas>
<div class="section"><h3>üì§ ÂåØÂá∫Â†±Ë°®</h3><div class="button-row">
<button onclick="exportToPDF()">üìÑ ÂåØÂá∫ PDF</button>
<button onclick="exportToExcel()">üìä ÂåØÂá∫ Excel</button>
</div>
</div>
<script>
const costItems = [
  { name: "Èò≤Â°µÂ∏É", unit: "m¬≤", key: "dustClothArea", price: 60 },
  { name: "Èò≤Â°µÁ∂≤", unit: "m¬≤", key: "dustNetArea", price: 50 },
  { name: "ÁÅëÊ∞¥ËªäÁÅëÊ∞¥", unit: "Êúà", key: "sprinklerMonth", price: 5000 },
  { name: "ÂÖ®ÈòªÈöîÂºèÂúçÁ±¨", unit: "ÂÖ¨Â∞∫", key: "level1FullFenceLength", price: 1500 },
  { name: "Á∞°ÊòìÂúçÁ±¨", unit: "Â∫ß", key: "simpleFenceCount", price: 3000 },
  { name: "Ê¥óËªäÂè∞", unit: "Â∫ß", key: "carWashSet", price: 800000 },
  { name: "Âä†Â£ìÊ¥óËªäË®≠ÂÇô", unit: "Âè∞", key: "pressureWasher", price: 300000 },
  { name: "Ê±°Ê≥•Ê∏ÖÈô§", unit: "Êúà", key: "sludgeCleanMonth", price: 20000 }
];

const rules = [
  d => d.hasVehicleAccess && d.carWashSet < 1 && d.pressureWasher < 1 ? "‚ùå Á¨¨10Ê¢ùÔºöËªäËºõÈÄ≤Âá∫ÊáâË®≠Ê¥óËªäÂè∞ÊàñÂä†Â£ìË®≠ÂÇô" : "",
  d => d.carWashSet >= 1 && d.sludgeCleanMonth < d.duration ? "‚ùå Ê¥óËªäÊ≤âÊæ±Ê±†ÊáâÊØèÊúàÊ∏ÖÈô§4Ê¨°Ê±°Ê≥•" : "",
  d => d.level1FullFenceLength < d.area * 0.3 ? "‚ùå Á¨¨6Ê¢ùÔºöÊáâË®≠Ë∂≥Â§†Èï∑Â∫¶ÂÖ®ÈòªÈöîÂúçÁ±¨" : "",
  d => d.area > 10000 && d.duration >= 12 ? "‚ùå Á¨¨18Ê¢ùÔºöÊáâË®≠ÊîùÂΩ±ËàáÁõ£Ê∏¨Ë®≠ÂÇô" : "",
  d => d.stage === "ÁµêÊßãÈ´îÊñΩÂ∑•" && d.dustClothArea + d.dustNetArea < d.area * 0.7 ? "‚ùå Á¨¨11Ê¢ùÔºöÁµêÊßãÈ´îÊñΩÂ∑•ÊáâÊúâÈò≤Â°µÂ∏ÉÔºèÁ∂≤" : "",
  d => d.stage === "ÊãÜÈô§Â∑•Á®ã" && d.pressureWasher < 1 ? "‚ùå Á¨¨14Ê¢ùÔºöÊãÜÈô§ÈöéÊÆµÊáâË®≠Âä†Â£ìÂô¥Ê∞¥" : ""
];

let chart = null;
let resultData = [];

window.onload = () => {
  const table = document.getElementById("facilityTable");
  costItems.forEach(item => {
    const row = document.createElement("tr");
    row.innerHTML = `<td>${item.name}</td><td><input type="number" id="${item.key}" /></td>
                     <td>${item.unit}</td><td><input type="number" id="price_${item.key}" value="${item.price}" /></td>`;
    table.appendChild(row);
  });
};

function calculate() {
  const area = parseFloat(document.getElementById("area").value);
  const duration = parseFloat(document.getElementById("duration").value);
  const stage = document.getElementById("stage").value;
  const hasVehicleAccess = document.getElementById("hasVehicleAccess").value === "ÊòØ";
  const values = { area, duration, stage, hasVehicleAccess };
  let total = 0;
  let html = "<h3>Ë©¶ÁÆóÁµêÊûú</h3><table><tr><th>È†ÖÁõÆ</th><th>Êï∏Èáè</th><th>ÂñÆ‰Ωç</th><th>ÂñÆÂÉπ</th><th>Â∞èË®à</th></tr>";
  const labels = [], data = [];
  resultData = [];
  costItems.forEach(item => {
    const qty = parseFloat(document.getElementById(item.key).value) || 0;
    const price = parseFloat(document.getElementById("price_" + item.key).value) || item.price;
    const subtotal = qty * price;
    total += subtotal;
    values[item.key] = qty;
    html += `<tr><td>${item.name}</td><td>${qty}</td><td>${item.unit}</td><td>${price}</td><td>${subtotal.toLocaleString()}</td></tr>`;
    if (subtotal > 0) {
      labels.push(item.name);
      data.push(subtotal);
      resultData.push([item.name, qty, item.unit, price, subtotal]);
    }
  });
  html += `</table><p id="animatedTotal" class="total-animated">Á∏ΩË®àÔºöÁ¥Ñ 0 ÂÖÉ</p><p style="display:none"><strong>Á∏ΩË®àÔºöÁ¥Ñ ${total.toLocaleString()} ÂÖÉ</strong></p>`;

  const warnings = rules.map(r => r(values)).filter(m => m).map(m => `<p class="warning">${m}</p>`).join("");
  document.getElementById("result").innerHTML = html + warnings;
animateTotal(total);

  if (chart) chart.destroy();
  const ctx = document.getElementById("chart").getContext("2d");
  chart = new Chart(ctx, {
    type: 'pie',
    data: { labels: labels, datasets: [{ data: data, backgroundColor: ['#4e79a7','#f28e2b','#e15759','#76b7b2','#59a14f','#edc948','#b07aa1','#ff9da7'] }] },
    options: { responsive: true, plugins: { legend: { position: 'right' }, title: { display: true, text: 'Ë®≠ÊñΩÁ∂ìË≤ªÂç†ÊØî' } } }
  });
}

function exportToExcel() {
  const ws = XLSX.utils.aoa_to_sheet([["È†ÖÁõÆ", "Êï∏Èáè", "ÂñÆ‰Ωç", "ÂñÆÂÉπ", "ÈáëÈ°ç"], ...resultData]);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "Ë©¶ÁÆóÁµêÊûú");
  XLSX.writeFile(wb, "Á©∫Ê±°Èò≤Âà∂Ë©¶ÁÆó.xlsx");
}

function exportToPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.setFontSize(14);
  doc.text("Á©∫Ê±°Èò≤Âà∂Á∂ìË≤ªË©¶ÁÆóÂ†±Ë°®", 20, 20);
  let y = 30;
  resultData.forEach(row => {
    doc.setFontSize(10);
    doc.text(`${row[0]}ÔΩú${row[1]} ${row[2]}ÔΩúÂñÆÂÉπ ${row[3]}ÔΩúÈáëÈ°ç ${row[4]}`, 20, y);
    y += 8;
  });
  doc.save("Á©∫Ê±°Èò≤Âà∂Ë©¶ÁÆó.pdf");
}
</script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  // Ê∑°ÂÖ•ÂãïÁï´
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) entry.target.classList.add("visible");
    });
  }, { threshold: 0.1 });
  document.querySelectorAll('.section').forEach(section => observer.observe(section));
});

function animateTotal(to) {
  const el = document.getElementById("animatedTotal");
  let start = 0;
  const duration = 1000;
  const step = (timestamp) => {
    if (!start) start = timestamp;
    const progress = Math.min((timestamp - start) / duration, 1);
    el.textContent = `Á∏ΩË®àÔºöÁ¥Ñ ${Math.floor(progress * to).toLocaleString()} ÂÖÉ`;
    if (progress < 1) requestAnimationFrame(step);
  };
  requestAnimationFrame(step);
}
</script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  const el = document.getElementById("typewriter");
  const text = "AI Êô∫ËÉΩÁ∑®ÂàóÁ©∫Ê∞£Ê±°ÊüìÈò≤Âà∂Á∂ìË≤ªË©¶ÁÆóÁ≥ªÁµ±";
  let i = 0;
  function type() {
    if (i < text.length) {
      el.textContent += text.charAt(i);
      i++;
      setTimeout(type, 80);
    }
  }
  type();
});
</script>
<footer style="position: fixed; bottom: 10px; right: 15px; font-size: 0.8em; color: #999;">
  Powered by Ëá∫Êù±Á∏£Áí∞‰øùÂ±Ä √ó GPT
</footer>
<script>
let chartRef = null;

function toggleSection(id) {
  document.querySelectorAll(".section").forEach(s => s.classList.remove("accordion-visible"));
  const target = document.getElementById(id);
  if (target) target.classList.add("accordion-visible");
}

function updateChartSummary(labels, data) {
  const total = data.reduce((a,b) => a + b, 0);
  let html = `<strong>Á∏ΩË®àÈáëÈ°çÔºö</strong>${total.toLocaleString()} ÂÖÉ<br><ul style="list-style:none;padding-left:0;">`;
  labels.forEach((label, i) => {
    const percent = ((data[i]/total)*100).toFixed(1);
    html += `<li>‚Ä¢ ${label}Ôºö${data[i].toLocaleString()} ÂÖÉ (${percent}%)</li>`;
  });
  html += "</ul>";
  document.getElementById("chartSummary").innerHTML = html;
}

// ‰øÆÊîπÂéü ChartJS ÂçÄÂüüÂëºÂè´ chartRef ËàáÊõ¥Êñ∞ÊëòË¶Å
</script>
<div class="chart-summary" id="chartSummary"></div>
</div></div><script>
document.addEventListener("DOMContentLoaded", function () {
  const typeSelect = document.getElementById("type");
  const table = document.querySelector("table tbody");

  const createAutoWashRow = () => {
    const tr = document.createElement("tr");
    tr.setAttribute("id", "auto-wash-row");

    tr.innerHTML = `
      <td><b>Ëá™ÂãïÊ¥óËªäË®≠ÂÇô</b></td>
      <td><input type="number" value="" /></td>
      <td>ÁµÑ</td>
      <td><input type="number" value="" /></td>
        `;
    return tr;
  };

  const updateAutoWash = () => {
    const type = typeSelect.value;
    const existingRow = document.getElementById("auto-wash-row");

    if (type === "ÁñèÊø¨" || type === "ÂçÄÂüüÈñãÁôº") {
      if (!existingRow) {
        const row = createAutoWashRow();
        table.appendChild(row);
        updateTotal();
      }
    } else {
      if (existingRow) {
        existingRow.remove();
        updateTotal();
      }
    }
  };

  typeSelect.addEventListener("change", updateAutoWash);
});
</script><script>
document.addEventListener("DOMContentLoaded", function () {
  const addButton = document.getElementById("add-row");
  const table = document.querySelector("table tbody");

  addButton.addEventListener("click", function () {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td><input type="text" value="" required /></td>        <!-- È†ÖÁõÆÂêçÁ®± -->
      <td><input type="number" value="" min="1" required /></td>  <!-- Êï∏Èáè -->
      <td><input type="text" value="" /></td>                 <!-- ÂñÆ‰Ωç -->
      <td><input type="number" value="" min="0" required /></td>  <!-- ÂñÆÂÉπ -->
    `;
    table.appendChild(tr);
    updateTotal();
  });
});
</script><script>
document.addEventListener("DOMContentLoaded", function () {
  const stageSelect = document.getElementById("stage");
  const stockpileArea = document.getElementById("stockpile-area");

  function checkStockpileByStage() {
    const value = stageSelect?.value || "";
    if (value.includes("ÂúüÊñπÈñãÊåñ")) {
      stockpileArea.style.display = "block";
    } else {
      stockpileArea.style.display = "none";
    }
  }

  if (stageSelect) {
    stageSelect.addEventListener("change", checkStockpileByStage);
    checkStockpileByStage();
  }
});
</script><script>
function exportToExcel() {
  const wb = XLSX.utils.book_new();
  const ws_data = [["È†ÖÁõÆ", "Êï∏Èáè", "ÂñÆ‰Ωç", "ÂñÆÂÉπ", "Â∞èË®à"]];
  document.querySelectorAll("table tbody tr").forEach(row => {
    const cells = row.querySelectorAll("td");
    if (cells.length >= 4) {
      const item = cells[0]?.querySelector("input")?.value || cells[0].innerText || "";
      const qty = cells[1]?.querySelector("input")?.value || "";
      const unit = cells[2]?.querySelector("input")?.value || cells[2].innerText || "";
      const price = cells[3]?.querySelector("input")?.value || "";
      const subtotal = (qty && price) ? parseFloat(qty) * parseFloat(price) : 0;
      ws_data.push([item, qty, unit, price, subtotal]);
    }
  });
  const ws = XLSX.utils.aoa_to_sheet(ws_data);
  XLSX.utils.book_append_sheet(wb, ws, "Á©∫Ê±°Ë©¶ÁÆóË°®");
  XLSX.writeFile(wb, "Á©∫Ê±°Èò≤Âà∂Ë©¶ÁÆóË°®.xlsx");
}

function exportToPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const headers = [["È†ÖÁõÆ", "Êï∏Èáè", "ÂñÆ‰Ωç", "ÂñÆÂÉπ", "Â∞èË®à"]];
  const data = [];

  document.querySelectorAll("table tbody tr").forEach(row => {
    const cells = row.querySelectorAll("td");
    if (cells.length >= 4) {
      const item = cells[0]?.querySelector("input")?.value || cells[0].innerText || "";
      const qty = cells[1]?.querySelector("input")?.value || "";
      const unit = cells[2]?.querySelector("input")?.value || cells[2].innerText || "";
      const price = cells[3]?.querySelector("input")?.value || "";
      const subtotal = (qty && price) ? parseFloat(qty) * parseFloat(price) : 0;
      data.push([item, qty, unit, price, subtotal]);
    }
  });

  doc.setFontSize(14);
  doc.text("Á©∫Ê±°Èò≤Âà∂Ë©¶ÁÆóË°®", 14, 15);
  doc.autoTable({
    head: headers,
    body: data,
    startY: 25,
    styles: { fontSize: 10, halign: 'center' },
    headStyles: { fillColor: [67, 160, 71], textColor: 255 }
  });

  doc.save("Á©∫Ê±°Èò≤Âà∂Ë©¶ÁÆóË°®.pdf");
}
</script><script>
function exportToExcel() {
  const wb = XLSX.utils.book_new();
  const ws_data = [["È†ÖÁõÆ", "Êï∏Èáè", "ÂñÆ‰Ωç", "ÂñÆÂÉπ", "Â∞èË®à"]];
  const seen = new Set(); // ÈÅéÊøæÈáçË§áÂàó‰æùÊìö„ÄåÈ†ÖÁõÆÂêçÁ®±+Êï∏Èáè+ÂñÆÂÉπ„Äç

  document.querySelectorAll("table tbody tr").forEach(row => {
    const cells = row.querySelectorAll("td");
    let qtyVal = "";
    const qtyCell = cells[1];
    const qtyInput = qtyCell?.querySelector("input");
    if (qtyInput) {
      qtyVal = qtyInput.value;
    } else {
      qtyVal = qtyCell?.innerText.trim();
    }
    if (!qtyVal || parseFloat(qtyVal) === 0) return;

    const item = cells[0]?.querySelector("input")?.value || cells[0].innerText.trim();
    const unit = cells[2]?.querySelector("input")?.value || cells[2].innerText.trim();
    const price = cells[3]?.querySelector("input")?.value || cells[3].innerText.trim();
    const subtotal = (qtyVal && price) ? parseFloat(qtyVal) * parseFloat(price) : 0;

    const key = `${item}_${qtyVal}_${price}`;
    if (seen.has(key)) return;
    seen.add(key);

    ws_data.push([item, qtyVal, unit, price, subtotal.toLocaleString()]);
  });

  const ws = XLSX.utils.aoa_to_sheet(ws_data);
  XLSX.utils.book_append_sheet(wb, ws, "Á©∫Ê±°Ë©¶ÁÆóË°®");
  XLSX.writeFile(wb, "Á©∫Ê±°Èò≤Âà∂Ë©¶ÁÆóË°®.xlsx");
}
</script><script>
async function exportToPDF() {
  prepareTableForExport();
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF('l', 'mm', 'a4'); // landscape Ê©´Âºè A4

  const content = document.querySelector("table").parentElement;

  const canvas = await html2canvas(content, {
    scale: 3,
    useCORS: true,
    windowWidth: content.scrollWidth,
    scrollX: 0,
    scrollY: 0
  });

  const imgData = canvas.toDataURL("image/png");

  const pdfWidth = 297; // A4 Ê©´ÂºèÂØ¨Â∫¶ mm
  const imgProps = doc.getImageProperties(imgData);
  const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

  doc.addImage(imgData, 'PNG', 0, 10, pdfWidth, pdfHeight);
  doc.save("Á©∫Ê±°Èò≤Âà∂Ë©¶ÁÆó_ÂÆåÊï¥Áâà.pdf");
}
</script><script>
function prepareTableForExport() {
  const inputs = document.querySelectorAll("table input");
  inputs.forEach(input => {
    const span = document.createElement("span");
    span.textContent = input.value;
    span.style.display = "inline-block";
    span.style.minWidth = "60px";
    span.style.padding = "4px";
    span.style.border = "1px solid #ccc";
    input.parentElement.replaceChild(span, input);
  });
}
</script></body>
</html>
